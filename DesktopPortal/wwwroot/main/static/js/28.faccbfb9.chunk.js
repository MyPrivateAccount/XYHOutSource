webpackJsonp([28],{1780:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return console.log("empDialogMapStateToProps:",e),{activeEmp:e.emp.activeEmp,operInfo:e.emp.operInfo,roleSource:e.role.roleSource,privList:e.emp.privList,treeSource:e.org.treeSource,activeTreeNode:e.org.activeTreeNode,permissionOrgTree:e.org.permissionOrgTree}}function l(e){return{dispatch:e}}var s=n(92),c=(n(479),n(0)),p=n.n(c),u=n(46),m=n(1281),h=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=u.o.Item,f=u.A.Option,g=u.J.TreeNode,b=function(e){function t(){var e,n,o,i;a(this,t);for(var l=arguments.length,s=Array(l),c=0;c<l;c++)s[c]=arguments[c];return n=o=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),o.state={empInfo:{},dialogTitle:"\u5458\u5de5\u4fe1\u606f",visible:!1,empOrgId:""},o.componentWillMount=function(){o.props.dispatch(Object(m.L)()),o.props.dispatch(Object(m.k)())},o.handleOk=function(e){e.preventDefault();var t=o.props.operInfo.operType;o.props.form.validateFields(function(e,n){if(!e){console.log("Received values of form: ",n);var a=n;"add"!=t&&(a=Object.assign({},o.props.activeEmp,n),a.roles=n.roles),a.filialeId=n.organizationId;var r="add"==t?"POST":"PUT";console.log("method:"+r+",empInfo:"+JSON.stringify(a)),o.props.dispatch(Object(m.p)({method:r,empInfo:a,activeEmp:o.props.activeEmp}))}})},o.handleCancel=function(e){o.props.dispatch(Object(m.i)())},i=n,r(o,i)}return o(t,e),h(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.operInfo,n=t.operType;t.result;"edit"==n?this.setState({empInfo:e.activeEmp,visible:!0,dialogTitle:"\u5458\u5de5\u7f16\u8f91"}):"add"==n?this.setState({empInfo:{organizationId:e.activeTreeNode.id,password:"123456"},visible:!0,dialogTitle:"\u5458\u5de5\u65b0\u589e"}):(this.setState({visible:!1}),this.props.form.resetFields())}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator,t={labelCol:{span:6},wrapperCol:{span:14}},n=function e(t){return t.map(function(t){return t.children?p.a.createElement(g,{title:t.name,key:t.key,value:t.key},e(t.children)):p.a.createElement(g,{title:t.name,key:t.key,value:t.key,isLeaf:t.isLeaf})})}(this.props.treeSource);return p.a.createElement(u.u,{width:600,title:this.state.dialogTitle,maskClosable:!1,visible:this.state.visible,onOk:this.handleOk,onCancel:this.handleCancel},p.a.createElement(u.z,null,p.a.createElement(u.k,{span:12},p.a.createElement(d,Object.assign({},t,{label:p.a.createElement("span",null,"\u5458\u5de5\u7f16\u53f7"),hasFeedback:!0}),e("userName",{initialValue:this.state.empInfo.userName,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5458\u5de5\u7f16\u53f7!"}]})(p.a.createElement(u.q,null)))),p.a.createElement(u.k,{span:12},p.a.createElement(d,Object.assign({},t,{label:p.a.createElement("span",null,"\u5458\u5de5\u59d3\u540d"),hasFeedback:!0}),e("trueName",{initialValue:this.state.empInfo.trueName,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5458\u5de5\u59d3\u540d!"}]})(p.a.createElement(u.q,null))))),p.a.createElement(u.z,null,p.a.createElement(u.k,{span:12},p.a.createElement(d,Object.assign({},t,{label:p.a.createElement("span",null,"\u8054\u7cfb\u7535\u8bdd"),hasFeedback:!0}),e("phoneNumber",{initialValue:this.state.empInfo.phoneNumber,rules:[{pattern:"^((1[0-9][0-9])|(14[5|7])|(15([0-3]|[5-9]))|(18[0,5-9]))\\d{8}$",message:"\u4e0d\u662f\u6709\u6548\u7684\u624b\u673a\u53f7\u7801!"},{required:!0,message:"\u8bf7\u8f93\u5165\u8054\u7cfb\u7535\u8bdd!"}]})(p.a.createElement(u.q,null)))),p.a.createElement(u.k,{span:12},p.a.createElement(d,Object.assign({},t,{label:p.a.createElement("span",null,"Email"),hasFeedback:!0}),e("email",{initialValue:this.state.empInfo.email,rules:[{type:"email",message:"\u8f93\u5165\u90ae\u4ef6\u5730\u5740\u4e0d\u6b63\u786e!"}]})(p.a.createElement(u.q,null))))),p.a.createElement(u.z,null,p.a.createElement(u.k,{span:12},p.a.createElement(d,Object.assign({},t,{label:p.a.createElement("span",null,"\u804c\u7ea7"),hasFeedback:!0}),e("position",{initialValue:this.state.empInfo.position})(p.a.createElement(u.A,{style:{width:200},placeholder:"\u8bf7\u9009\u62e9\u804c\u7ea7"},this.props.privList.map(function(e,t){return p.a.createElement(f,{key:e.value},e.key)}))))),p.a.createElement(u.k,{span:12},"add"==this.props.operInfo.operType?p.a.createElement(d,Object.assign({},t,{label:p.a.createElement("span",null,"\u521d\u59cb\u5bc6\u7801"),hasFeedback:!0}),e("password",{initialValue:this.state.empInfo.password,rules:[{min:6,message:"\u8bf7\u8f93\u5165\u81f3\u5c116\u4f4d\u5bc6\u7801!"},{required:!0,message:"\u8bf7\u8f93\u5165\u521d\u59cb\u5bc6\u7801!"}]})(p.a.createElement(u.q,{type:"password"}))):null)),p.a.createElement(u.z,null,p.a.createElement(u.k,{span:12},p.a.createElement(d,Object.assign({},t,{label:p.a.createElement("span",null,"\u6240\u5c5e\u90e8\u95e8"),hasFeedback:!0}),e("organizationId",{initialValue:this.state.empInfo.organizationId,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u6240\u5c5e\u90e8\u95e8!"}]})(p.a.createElement(u.J,{style:{width:300},dropdownStyle:{maxHeight:400,overflow:"auto"},treeData:this.props.permissionOrgTree.AddUserTree,placeholder:"\u8bf7\u9009\u62e9\u6240\u5c5e\u90e8\u95e8"},n))))))}}]),t}(c.Component),E=u.o.create()(b);t.a=Object(s.b)(i,l)(E)},1781:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return{activeEmp:e.emp.activeEmp,operInfo:e.emp.operInfo,roleSource:e.role.roleSource}}function l(e){return{dispatch:e}}var s=n(92),c=(n(479),n(0)),p=n.n(c),u=n(46),m=n(1281),h=n(1782),d=(n.n(h),function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}()),f=u.j.Group,g=function(e){function t(){var e,n,o,i;a(this,t);for(var l=arguments.length,s=Array(l),c=0;c<l;c++)s[c]=arguments[c];return n=o=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),o.state={dialogTitle:"\u5458\u5de5\u6743\u9650",visible:!1,roleOptions:[],checkedRoles:[]},o.componentWillMount=function(){o.props.dispatch(Object(m.L)())},o.handleOk=function(e){var t=o.state.checkedRoles,n=[];o.props.activeEmp.roles&&o.props.activeEmp.roles.map(function(e){void 0==o.state.checkedRoles.find(function(t){return t==e})&&n.push(e)}),console.log("addroles,removeroles,",t,n),o.props.dispatch(Object(m.o)({addRoles:t,removeRoles:n,userName:o.props.activeEmp.userName}))},o.handleCancel=function(e){o.props.dispatch(Object(m.i)())},o.handleRoelChange=function(e){console.log("\u89d2\u8272\u9009\u62e9",e),o.setState({checkedRoles:e})},i=n,r(o,i)}return o(t,e),d(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.operInfo.empRoleOperType,n=[];console.log(e.activeEmp),e.roleSource.map(function(e){n.push({label:e.name,value:e.name})}),console.log("\u5f53\u524d\u7528\u6237\uff1a",e.activeEmp.roles),this.setState({roleOptions:n,checkedRoles:e.activeEmp.roles}),"edit"==t?this.setState({visible:!0,dialogTitle:"\u5458\u5de5\u6743\u9650"}):this.setState({visible:!1})}},{key:"render",value:function(){var e=this;return p.a.createElement(u.u,{width:600,title:this.state.dialogTitle,maskClosable:!1,visible:this.state.visible,onOk:function(t){return e.handleOk(t)},onCancel:this.handleCancel},p.a.createElement("div",{style:{color:"rgba(0, 0, 0, 0.85)"}},p.a.createElement(u.z,{style:{margin:"2px"}},p.a.createElement(u.k,{span:3},"\u7528\u6237\u540d\uff1a"),p.a.createElement(u.k,{span:21},p.a.createElement("b",null,this.props.activeEmp.trueName))),p.a.createElement(u.z,{style:{margin:"2px"}},p.a.createElement(u.k,{span:3},"\u6240\u5c5e\u89d2\u8272\uff1a"),p.a.createElement(u.k,{span:21}," ",p.a.createElement(f,{options:this.state.roleOptions,value:this.state.checkedRoles,onChange:this.handleRoelChange})))))}}]),t}(c.Component);t.a=Object(s.b)(i,l)(g)},1782:function(e,t,n){var a=n(1783);"string"===typeof a&&(a=[[e.i,a,""]]);var r={};r.transform=void 0;n(477)(a,r);a.locals&&(e.exports=a.locals)},1783:function(e,t,n){t=e.exports=n(476)(!0),t.push([e.i,".ant-checkbox-wrapper{margin-left:0!important;margin-right:8px}","",{version:3,sources:["E:/work/XYH/xinyaohang/DesktopPortal/src/privilegeManager/pages/employee/empRoleStyle.less"],names:[],mappings:"AAAA,sBACE,wBAA0B,AAC1B,gBAAkB,CACnB",file:"empRoleStyle.less",sourcesContent:[".ant-checkbox-wrapper {\n  margin-left: 0 !important;\n  margin-right: 8px;\n}\n"],sourceRoot:""}])},2071:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function i(e){return console.log("empTableMapStat:"+JSON.stringify(e.emp.empSearchResult)),{operInfo:e.emp.operInfo,activeTreeNode:e.org.activeTreeNode,empSearchResult:e.emp.empSearchResult,permissionOrgTree:e.org.permissionOrgTree,roleSource:e.role.roleSource,treeSource:e.org.treeSource}}function l(e){return{dispatch:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=n(92),c=n(1281),p=n(0),u=n.n(p),m=n(46),h=n(1780),d=n(1781),f=n(1764),g=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),b=m.s.Header,E=m.s.Content,v=m.A.Option,y=m.J.TreeNode,k=function(e){function t(){var e,n,o,i;a(this,t);for(var l=arguments.length,s=Array(l),p=0;p<l;p++)s[p]=arguments[p];return n=o=r(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),o.state={checkList:[],condition:{isSearch:!0,keyWords:"",roleId:"",OrganizationIds:[]},empDataLoading:!1,pagination:{}},o.componentWillMount=function(){0===o.props.permissionOrgTree.AddUserTree.length&&o.props.dispatch(Object(c.t)("UserInfoCreate")),o.handleSearch()},o.handleEmpRoleClick=function(e){console.log("\u5458\u5de5\u7f16\u8f91\uff1a",e),o.props.dispatch(Object(c.n)(e))},o.appTableColumns=[{title:"\u9009\u62e9",dataIndex:"clientID",key:"check",render:function(e,t){return u.a.createElement("span",null,u.a.createElement(m.j,{defaultChecked:!1,onChange:function(e){return o.handleCheckChange(e,t)}}))}},{title:"\u7528\u6237\u540d",dataIndex:"userName",key:"userName"},{title:"\u771f\u5b9e\u59d3\u540d",dataIndex:"trueName",key:"trueName"},{title:"\u8054\u7cfb\u7535\u8bdd",dataIndex:"phoneNumber",key:"phoneNumber"},{title:"\u90ae\u7bb1",dataIndex:"email",key:"email"},{title:"\u7f16\u8f91",dataIndex:"edit",key:"edit",render:function(e,t){return u.a.createElement("span",null,u.a.createElement(m.H,{title:"\u7528\u6237\u7f16\u8f91"},u.a.createElement(m.g,{type:"primary",shape:"circle",size:"small",icon:"edit",onClick:function(e){return o.handleEditClick(t)}})),u.a.createElement(m.H,{title:"\u7528\u6237\u6743\u9650\u8bbe\u7f6e"},"\xa0",u.a.createElement(m.g,{type:"primary",shape:"circle",size:"small",icon:"team",onClick:function(e){return o.handleEmpRoleClick(t)}})),u.a.createElement(m.H,{title:"\u91cd\u7f6e\u5bc6\u7801"},u.a.createElement(m.w,{title:"\u786e\u8ba4\u8981\u91cd\u7f6e\u9009\u4e2d\u7528\u6237\u5bc6\u7801?",onConfirm:function(e){return o.handleResetPwd(t)},onCancel:o.cancelDelete,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},"\xa0",u.a.createElement(m.g,{type:"primary",shape:"circle",size:"small",icon:"retweet"}))))}}],o.handleEmpDelete=function(e){var t=[];o.state.checkList.map(function(e,n){1==e.status&&t.push(e.id)}),console.log("\u5220\u9664\u5217\u8868\uff1a",t),o.props.dispatch(Object(c.h)(t))},o.handleResetPwd=function(e){console.log("\u91cd\u7f6e\u5bc6\u7801\uff1a",e),o.props.dispatch(Object(c.m)(e.userName))},o.handleAddClick=function(e){console.log("handleAddClick"),o.props.dispatch(Object(c.g)())},o.handleEditClick=function(e){console.log("handleEditClick",e),o.props.dispatch(Object(c.j)(e))},o.handleCheckChange=function(e,t){var n=t.id,a=e.target.checked,r=o.state.checkList.slice(),i=!1;for(var l in r)if(r[l].id==n){r[l].status=a,i=!0;break}i||r.push({id:n,status:a}),o.setState({checkList:r})},o.handleUserNameChange=function(e){var t=Object.assign({},o.state.condition);t.keyWords=e.target.value,o.setState({condition:t})},o.handleSearch=function(e){f.a.empSearchCondition=o.state.condition,f.a.empSearchCondition.pageIndex=0,f.a.empSearchCondition.pageSize=10,console.log("\u67e5\u8be2\u6761\u4ef6",f.a),o.setState({empDataLoading:!0}),o.props.dispatch(Object(c.l)(f.a.empSearchCondition))},o.handleTableChange=function(e,t,n){f.a.empSearchCondition.pageIndex=e.current-1,f.a.empSearchCondition.pageSize=e.pageSize,console.log("table\u6539\u53d8\uff0c",e),o.props.dispatch(Object(c.l)(f.a.empSearchCondition))},o.handleRoleChange=function(e){console.log("\u89d2\u8272\u53d8\u66f4:",e);var t=Object.assign({},o.state.condition);t.roleId=e,o.setState({condition:t})},o.handleOrgChange=function(e){console.log("\u90e8\u95e8\u6539\u53d8:",e);var t=Object.assign({},o.state.condition);t.OrganizationIds=e,o.setState({condition:t})},i=n,r(o,i)}return o(t,e),g(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({empDataLoading:!1});var t={pageSize:e.empSearchResult.pageSize,current:e.empSearchResult.pageIndex,total:e.empSearchResult.totalCount};console.log("\u5206\u9875\u4fe1\u606f\uff1a",t),this.setState({pagination:t})}},{key:"render",value:function(){var e=(this.state.checkList.filter(function(e){return e.status}).length,[]);this.props.roleSource&&this.props.roleSource.map(function(t){return e.push(u.a.createElement(v,{key:t.id},t.name))});var t=function e(t){return t.map(function(t){return t.children?u.a.createElement(y,{title:t.name,key:t.key,value:t.key},e(t.children)):u.a.createElement(y,{title:t.name,key:t.key,value:t.key,isLeaf:t.isLeaf})})}(this.props.treeSource);return u.a.createElement("div",{className:"relative"},u.a.createElement(m.s,null,u.a.createElement(b,null,"\u5458\u5de5\u5217\u8868"),u.a.createElement(E,null,u.a.createElement(m.z,null,u.a.createElement(m.k,{style:{margin:"7px 5px"}},u.a.createElement("div",null,u.a.createElement(m.z,null,u.a.createElement(m.k,{span:6},"\u7528\u6237\u540d: ",u.a.createElement(m.q,{value:this.state.condition.keyWords,style:{width:"70%",verticalAlign:"middle"},onPressEnter:this.handleSearch,onChange:this.handleUserNameChange})),u.a.createElement(m.k,{span:6},"\u6240\u5c5e\u89d2\u8272: ",u.a.createElement(m.A,{style:{width:"70%"},value:this.state.condition.roleId,allowClear:!0,onChange:this.handleRoleChange},e)),u.a.createElement(m.k,{span:6},"\u6240\u5c5e\u90e8\u95e8:",u.a.createElement(m.J,{style:{width:"70%"},allowClear:!0,multiple:!0,dropdownStyle:{maxHeight:400,overflow:"auto"},onChange:this.handleOrgChange,value:this.state.condition.OrganizationIds,treeData:this.props.permissionOrgTree.AddUserTree},t)),u.a.createElement(m.k,{span:6},u.a.createElement(m.g,{type:"primary",icon:"search",onClick:this.handleSearch},"\u67e5\u8be2")))))),u.a.createElement(m.B,{spinning:this.state.empDataLoading},u.a.createElement(m.D,{rowKey:function(e){return e.userName},pagination:this.state.pagination,columns:this.appTableColumns,dataSource:this.props.empSearchResult.extension,onChange:this.handleTableChange})),u.a.createElement(h.a,null),u.a.createElement(d.a,null))))}}]),t}(p.Component);t.default=Object(s.b)(i,l)(k)}});
//# sourceMappingURL=28.faccbfb9.chunk.js.map